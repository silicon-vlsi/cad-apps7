#! /bin/sh
#
# This script is based onMentor Graphics autostart script mgc.linux.rhel
# and appropriate changes were made for out local installation. 
# -srout 2019/01/20
# 
# DON'T REMOVE the #  below. 
# chkconfig: 345 99 30 
# 
# description: Starts and stops the Mentor License Server  
 
PATH=/sbin:/usr/sbin:/usr/bin:/bin 
export PATH 
LM_LICENSE_FILE_MGC=/CAD/licenseServers/mentor/license-current.dat
export LM_LICENSE_FILE_MGC
##Flex ver 11.13.1.2
#LIC_SW_HOME=/CAD/licenseServers/mentor/mgls_v9-16_5-1-0.ixl
##Flex ver 11.16.0.0
##LIC_SW_HOME=/CAD/licenseServers/mentor/mgls_v9-19_8-1-0.ixl
##Flex ver v11.16.4.0 build 252457 i86_lsb -- srout 10/29/2019
LIC_SW_HOME=/CAD/licenseServers/mentor/mgls_v9-23_5-6-0.aol
export LIC_SW_HOME 

LIC_LOGFILE=/var/tmp/lmgrd.log 
export LIC_LOGFILE 
 
# Source networking configuration. 
. /etc/sysconfig/network 
 
# Check that networking is up. 
[ ${NETWORKING} = "no" ] && exit 0 
 
# Check that license file  exists. 
[ -f $LM_LICENSE_FILE_MGC ] || exit 0 
 
# See how we were called. 
 
case "$1" in 
  start) 
 
        # Note: The su line must not be divided by line continuation (\)  
        # in this example, the line is word wrapped, but it is one line 
        echo -n "Starting Mentor License Server: " 
        su -c "$LIC_SW_HOME/bin/lmgrd -c $LM_LICENSE_FILE_MGC -L +$LIC_LOGFILE" cdslic 
	echo ""
        ;; 
  stop) 
        echo "Shutting down Mentor License Server: " 
        $LIC_SW_HOME/bin/lmdown -q -force -c $LM_LICENSE_FILE_MGC
        echo "" 
        ;; 
  status) 
        $LIC_SW_HOME/bin/lmstat -a -c $LM_LICENSE_FILE_MGC
        echo "" 
        ;; 
  restart) 
        echo "Restarting the Cadence and Mentor License Server: " 
        $0 stop 
        $0 start 
        ;; 
  lmver) 
        $LIC_SW_HOME/bin/lmver $LIC_SW_HOME/bin/lmgrd
        echo "" 
        ;; 
  *) 
        echo "Usage: cdslic {start|stop|restart|status|lmver}" 
        exit 1 
esac 
